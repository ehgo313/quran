{{ define "main" }}
<section class="prose prose-a:no-underline hover:prose-a:underline max-w-none">
    <h1>{{ .Title }}</h1>
    <p>{{ .Description }}</p>
    <input type="search" name="search" id="search" placeholder="Cari Nama Surah" class="w-full">
    <hr>
    <p class="hidden" id="surah-empty-message" data-nosnippet>Surah Yang Dicari Tidak Ditemukan</p>
    <ol id="surah-list">
        {{ $site := .Site }}
        {{ range sort $site.Data.surah "no" "asc" }}
        {{ with $site.GetPage (printf "/surah/%s" .slug) }}
            <li>
                <div class="flex justify-between">
                    <a href="{{ .RelPermalink }}">{{ .Title }}</a>
                    <a href="{{ .RelPermalink }}" dir="rtl" class="font-arab text-xl">{{ .Params.arabic }}</a>
                </div>
            </li>
        {{ end }}
        {{ end }}
    </ol>
</section>
{{ end }}

{{ define "script" }}
<script>
    const allSurah = [
        {{ $site := .Site }}
        {{ range sort $site.Data.surah "no" "asc" }}
        {{ with $site.GetPage (printf "/surah/%s" .slug) }}
            {
                "title": "{{ .Title }}",
                "arabic": "{{ .Params.arabic }}",
                "link": "{{ .RelPermalink }}",
            },
        {{ end }}
        {{ end }}
    ]

    document
        .querySelector('#search')
        .addEventListener('input', e => {
            const filteredSurah = allSurah.filter(surah => surah.title.toLowerCase().includes(e.target.value))

            if (!filteredSurah.length) {
                document.querySelector('#surah-list')
                    .innerHTML = ''
                document
                    .querySelector('#surah-empty-message')
                    .classList
                    .remove('hidden')
            } else {
                document
                    .querySelector('#surah-empty-message')
                    .classList
                    .add('hidden')
                    
                document
                    .querySelector('#surah-list')
                    .innerHTML = filteredSurah.map(surah => `
                        <li>
                            <div class="flex justify-between">
                                <a href="${surah.link}">${surah.title}</a>
                                <a href="${surah.link}" dir="rtl" class="font-arab text-xl">${surah.arabic}</a>
                            </div>
                        </li>
                    `).join('')
            }
        })
</script>
{{ end }}